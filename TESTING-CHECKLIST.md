# PayUNi 外掛測試工作清單

照順序做，做完打勾。

---

## 一、環境準備

- [ ] 打開 Local.app，啟動 **buygo** 站（Start），等 MySQL + 網站跑起來。
- [ ] 確認 WordPress 後台這顆外掛是「啟用」狀態（不需重新啟用，已是改完的版本）。

---

## 二、訂閱日期修復（避免舊資料再被每 5 分鐘扣款）

- [ ] 開終端機，執行：

```bash
cd "/Users/fishtv/Local Sites/buygo/app/public"
wp eval-file wp-content/plugins/fluentcart-payuni/fix-subscription-billing-dates.php
```

- [ ] 看輸出：若顯示「沒有找到需要修正的訂閱」或「修正了 N 筆」都算完成。

---

## 三、後台 UI 確認（方案 1 已實施）

- [ ] 進 wp-admin，看左側選單：應該**沒有**「PayUNi 訂閱」子選單，只有 FluentCart 原本的項目。
- [ ] 訂閱改從 FluentCart 的訂閱列表／訂單頁操作即可。

---

## 四、退款測試（用那十幾筆 30 元）

**4-1 試刀（1～2 筆）**

- [ ] 進 FluentCart 後台（左側點 FluentCart Pro → 訂單或訂閱相關頁）。
- [ ] 找到一筆「30 元、PayUNi 付款、已付款」的訂單，點進去。
- [ ] 在該訂單頁面按「退款」→ 選**全額退款**→ 送出。
- [ ] 檢查 FluentCart：該訂單有退款記錄、狀態正確。
- [ ] 檢查 PayUNi 後台：同一筆交易顯示已退款。
- [ ] 再挑一筆重複上述步驟（可選）。

**4-2 批次退完其餘**

- [ ] 對其餘每筆 30 元 PayUNi 訂單，一筆筆在 FluentCart 後台做「全額退款」。
- [ ] 退完後抽檢幾筆，確認 PayUNi 後台狀態一致。

---

## 五、之後可選：訂閱續扣測試

（等你想再測一次小額扣款時再做）

- [ ] 建一個低價訂閱方案（例如 10 元／年）。
- [ ] 自己下單完成一次訂閱初次付款。
- [ ] 用 DB 或腳本把該訂閱的 `next_billing_date` 改成昨天。
- [ ] 等 5～10 分鐘，確認只產生一筆 renewal，不會每 5 分鐘扣一次。

---

## 完成後

- 若某一步出錯：把**錯誤訊息**或**畫面說明**貼給 AI，方便排查。
- 若全部勾完且 PayUNi 後台狀態都對，代表這版外掛的退款＋訂閱邏輯已驗證通過。
